@model CuaHangQuanAo.Models.ViewModels.StorageListVm
@{
    ViewData["Title"] = "Danh sách nhập kho";
    Layout = "_AdminLayout";
    int currentPage = Model.Page;
    int totalPages = Model.TotalPages;
    int totalRecords = Model.TotalRecords;
    int pageSize = Model.PageSize;
    int startRecord = (currentPage - 1) * pageSize + 1;
    int endRecord = Math.Min(currentPage * pageSize, totalRecords);
}
<!-- CSS omitted for brevity, keep as is -->
<style>
    .page-title-box {
        background: linear-gradient(135deg, #6a11cb 0%, #2575fc 100%);
        color: white;
        border-radius: 10px;
        padding: 2rem;
        margin-bottom: 2rem;
        box-shadow: 0 4px 20px rgba(0, 0, 0, 0.1);
    }

    .card {
        transition: all 0.3s;
        border: none;
        border-radius: 0.8rem;
    }

        .card:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.1) !important;
        }

    .table th {
        font-weight: 600;
        text-transform: uppercase;
        font-size: 0.82rem;
        letter-spacing: 0.5px;
    }

    .table-hover tbody tr:hover {
        background-color: rgba(37, 117, 252, 0.05);
    }

    .action-buttons {
        display: flex;
        justify-content: center;
        align-items: center;
        gap: 1rem; /* Khoảng cách đều giữa các nút */
    }

    .btn-action {
        min-width: 90px;
        border-radius: 24px !important;
        font-weight: 500;
        font-size: 0.70rem;
        padding: 0.18rem 0.9rem;
        border: 2px solid;
        background: #fff;
        display: flex;
        align-items: center;
        justify-content: center;
        transition: all 0.2s;
        line-height: 1.2;
    }

    btn-action i {
        font-size: 1em;
        margin-right: 0.4em;
        margin-bottom: 0;
    }


    .btn-action.detail {
        color: #1976d2;
        border-color: #1976d2;
    }

        .btn-action.detail:hover {
            background: #e3f0fd;
        }

    .btn-action.edit {
        color: #f9a825;
        border-color: #f9a825;
    }

        .btn-action.edit:hover {
            background: #fffbe6;
        }

    .btn-action.delete {
        color: #d32f2f;
        border-color: #d32f2f;
    }

        .btn-action.delete:hover {
            background: #fdeaea;
        }


    .action-buttons .btn {
        border-radius: 50px;
        padding: 0.4rem 1rem;
        transition: all 0.2s;
    }

        .action-buttons .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
        }

    .badge-cost {
        background: linear-gradient(45deg, #11998e, #38ef7d);
        color: white;
        border-radius: 50px;
        padding: 0.5rem 1rem;
        font-weight: 500;
    }

    .empty-state {
        padding: 3rem 2rem;
        opacity: 0.8;
    }

        .empty-state i {
            font-size: 4rem;
            opacity: 0.5;
        }

    .add-button {
        font-weight: 600;
        padding: 0.6rem 1.5rem;
        border-radius: 50px;
        box-shadow: 0 4px 10px rgba(40, 167, 69, 0.3);
    }

    .table-responsive {
        border-radius: 0.8rem;
        overflow: hidden;
    }

    .supplier-name {
        font-weight: 500;
        color: #495057;
    }

    .date-badge {
        background-color: #f8f9fa;
        border: 1px solid #dee2e6;
        border-radius: 4px;
        padding: 0.3rem 0.6rem;
        font-size: 0.875rem;
    }

    .pagination {
        display: flex;
        list-style: none;
        padding-left: 0;
    }

    .page-item {
        margin: 0 2px;
    }

    .page-link {
        color: #007bff;
        border: 1px solid #dee2e6;
        padding: 6px 12px;
        border-radius: 4px;
        text-decoration: none;
        background: #fff;
        transition: background 0.2s;
    }

    .page-item.active .page-link {
        background: #007bff;
        color: #fff;
        border-color: #007bff;
    }

    .page-item.disabled .page-link {
        color: #6c757d;
        pointer-events: none;
        background: #f8f9fa;
    }

    .page-link:hover {
        background: #e9ecef;
    }

    /* CSS cho phân trang */
    .pagination .page-link {
        color: #6a11cb;
        border-color: #dee2e6;
    }

    .pagination .page-item.active .page-link {
        background: linear-gradient(135deg, #6a11cb 0%, #2575fc 100%);
        border-color: #6a11cb;
    }

    .pagination .page-item.disabled .page-link {
        color: #6c757d;
    }

    .pagination .page-link:hover {
        color: #5a0cb9;
        background-color: #e9ecef;
        border-color: #dee2e6;
    }

    .pagination .page-item.active .page-link:hover {
        color: #fff;
    }

    /* CSS cho thông báo */
    .alert-success {
        background-color: #d1e7dd;
        border-color: #badbcc;
        color: #0f5132;
        padding: 1rem;
        border-radius: 0.5rem;
        margin-bottom: 1.5rem;
    }

    .alert-danger {
        background-color: #f8d7da;
        border-color: #f5c2c7;
        color: #842029;
        padding: 1rem;
        border-radius: 0.5rem;
        margin-bottom: 1.5rem;
    }

    .alert-dismissible .btn-close {
        padding: 1.25rem 1rem;
    }

    .product-info {
        display: flex;
        align-items: center;
    }

    .product-image {
        width: 40px;
        height: 40px;
        border-radius: 4px;
        margin-right: 10px;
        object-fit: cover;
        background-color: #f0f0f0;
        display: flex;
        justify-content: center;
        align-items: center;
    }

    .product-details {
        display: flex;
        flex-direction: column;
    }

    .product-name {
        font-weight: 500;
        color: #2d3748;
        margin-bottom: 0.25rem;
    }

    .product-meta {
        font-size: 0.85rem;
        color: #718096;
    }

</style>

<div class="container py-4">
    @if (TempData["SuccessMessage"] != null)
    {
        <div class="alert alert-success alert-dismissible fade show" role="alert">
            <i class="bi bi-check-circle me-1"></i> @TempData["SuccessMessage"]
            <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
        </div>
    }
    @if (TempData["ErrorMessage"] != null)
    {
        <div class="alert alert-danger alert-dismissible fade show" role="alert">
            <i class="bi bi-exclamation-triangle me-1"></i> @TempData["ErrorMessage"]
            <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
        </div>
    }

    <div class="page-title-box d-flex justify-content-between align-items-center">
        <div>
            <h2 class="mb-1 fw-bold">
                <i class="bi bi-inbox me-2"></i>Danh sách nhập kho
            </h2>
            <p class="text-white-50 mb-0">Quản lý thông tin nhập kho và hàng hóa</p>
        </div>
        <a class="btn btn-light add-button" href="@Url.Action("Functions_Create", "Storage")">
            <i class="bi bi-plus-circle-fill me-2"></i> Thêm phiếu nhập
        </a>
    </div>

    <div class="row mb-4">
        <div class="col-md-4">
            <div class="card shadow-sm mb-3">
                <div class="card-body p-3">
                    <div class="d-flex align-items-center">
                        <div class="rounded-circle bg-primary bg-opacity-10 p-3">
                            <i class="bi bi-box-seam text-primary fs-4"></i>
                        </div>
                        <div class="ms-3">
                            <h6 class="mb-1 text-muted">Tổng phiếu nhập</h6>
                            <h4 class="mb-0 fw-bold">@totalRecords</h4>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="col-md-4">
            <div class="card shadow-sm mb-3">
                <div class="card-body p-3">
                    <div class="d-flex align-items-center">
                        <div class="rounded-circle bg-success bg-opacity-10 p-3">
                            <i class="bi bi-currency-dollar text-success fs-4"></i>
                        </div>
                        <div class="ms-3">
                            <h6 class="mb-1 text-muted">Tổng chi phí nhập</h6>
                            <h4 class="mb-0 fw-bold">@string.Format("{0:N0} đ", Model.TotalCost)</h4>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="col-md-4">
            <div class="card shadow-sm mb-3">
                <div class="card-body p-3">
                    <div class="d-flex align-items-center">
                        <div class="rounded-circle bg-info bg-opacity-10 p-3">
                            <i class="bi bi-calendar-event text-info fs-4"></i>
                        </div>
                        <div class="ms-3">
                            <h6 class="mb-1 text-muted">Lần nhập gần nhất</h6>
                            <h4 class="mb-0 fw-bold">
                                @(Model.LatestImportDate ?? "Chưa có")
                            </h4>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Main Data Card -->
    <div class="card shadow">
        <div class="card-header bg-white py-3">
            <div class="d-flex justify-content-between align-items-center">
                <h5 class="mb-0">
                    <i class="bi bi-table me-2 text-primary"></i> Dữ liệu nhập kho
                </h5>
                <div class="input-group" style="width: 300px;">
                    <form method="get" class="d-flex w-100">
                        <input type="text" class="form-control" placeholder="Tìm kiếm sản phẩm..."
                               name="searchTerm" value="@Model.SearchTerm">
                        <button class="btn btn-outline-secondary" type="submit">
                            <i class="bi bi-search"></i>
                        </button>
                    </form>
                </div>
            </div>
        </div>
        <div class="card-body p-0">
            <div class="table-responsive">
                <table class="table table-hover align-middle mb-0">
                    <thead>
                        <tr class="bg-light">
                            <th scope="col" style="width:5%">#</th>
                            <th scope="col" style="width:15%">
                                <i class="bi bi-calendar me-1 text-secondary"></i> Ngày nhập
                            </th>
                            <th scope="col" style="width:20%">
                                <i class="bi bi-box me-1 text-secondary"></i> Thông tin sản phẩm
                            </th>
                            <th scope="col" style="width:20%">
                                <i class="bi bi-building me-1 text-secondary"></i> Nhà cung cấp
                            </th>
                            <th scope="col" style="width:10%" class="text-center">
                                <i class="bi bi-123 me-1 text-secondary"></i> Số lượng
                            </th>
                            <th scope="col" style="width:15%" class="text-center">
                                <i class="bi bi-cash me-1 text-secondary"></i> Tổng tiền
                            </th>
                            <th scope="col" class="text-center" style="width:15%">
                                <i class="bi bi-sliders me-1 text-secondary"></i> Hành động
                            </th>
                        </tr>
                    </thead>
                    <tbody>
                        @if (Model.Storages != null && Model.Storages.Any())
                        {
                            int stt = (currentPage - 1) * pageSize + 1;
                            foreach (var item in Model.Storages)
                            {
                                <tr>
                                    <td class="fw-bold text-secondary">@stt</td>
                                    <td>
                                        <div class="d-flex align-items-center">
                                            <i class="bi bi-calendar-event me-2 text-primary"></i>
                                            <span>@item.ImportDate?.ToString("dd/MM/yyyy")</span>
                                        </div>
                                    </td>
                                    <td>
                                        <div class="product-info">
                                            <div class="product-image">
                                                <i class="bi bi-box text-primary"></i>
                                            </div>
                                            <div class="product-details">
                                                <span class="product-name">@item.ProductVariants?.Product?.ItemsName</span>
                                                <span class="product-meta">
                                                    Size: @item.ProductVariants?.Size,
                                                    Color: @item.ProductVariants?.Color
                                                </span>
                                            </div>
                                        </div>
                                    </td>
                                    <td>
                                        <div class="d-flex align-items-center">
                                            <i class="bi bi-building me-2 text-success"></i>
                                            <span>@item.Supplier?.SupplierName</span>
                                        </div>
                                        <small class="text-muted">@item.Supplier?.PhoneNumber</small>
                                    </td>
                                    <td class="text-center">
                                        <span class="fw-bold">@item.Quantity</span>
                                    </td>
                                    <td class="text-center">
                                        @{
                                            var total = (item.Quantity ?? 0) * (item.ImportCost ?? 0);
                                        }
                                        <span class="fw-bold text-success">@string.Format("{0:N0} đ", total)</span>
                                    </td>
                                    <td>
                                        <div class="action-buttons">
                                            <a class="btn btn-action detail" href="@Url.Action("Functions_Details", "Storage", new { id = item.StorageId })" title="Chi tiết">
                                                <i class="bi bi-eye me-1"></i> Chi tiết
                                            </a>
                                            <a class="btn btn-action edit" href="@Url.Action("Functions_Edit", "Storage", new { id = item.StorageId })" title="Sửa">
                                                <i class="bi bi-pencil-square me-1"></i> Sửa
                                            </a>
                                            <a class="btn btn-action delete" href="@Url.Action("Functions_Delete", "Storage", new { id = item.StorageId })" title="Xóa">
                                                <i class="bi bi-trash me-1"></i> Xóa
                                            </a>
                                        </div>
                                    </td>
                                </tr>
                                stt++;
                            }
                        }
                        else
                        {
                            <tr>
                                <td colspan="7" class="text-center text-muted p-5">
                                    <i class="bi bi-inbox-fill mb-3" style="font-size: 2.5rem; opacity: 0.5;"></i>
                                    <h5>Không có dữ liệu nhập kho</h5>
                                    <p class="mb-0">Vui lòng thêm phiếu nhập kho mới hoặc thay đổi tiêu chí tìm kiếm</p>
                                </td>
                            </tr>
                        }
                    </tbody>
                </table>
            </div>
        </div>
        <div class="card-footer bg-white py-3">
            <div class="d-flex justify-content-between align-items-center">
                <span class="text-muted small">Hiển thị @(Model.Storages?.Count() ?? 0) phiếu nhập kho</span>

                @if (Model.LowStockOnly)
                {
                    <div class="alert alert-warning mb-4">
                        <div class="d-flex align-items-center">
                            <i class="bi bi-exclamation-triangle-fill me-2 fs-4"></i>
                            <div>
                                <h5 class="mb-1">Đang lọc: Sản phẩm sắp hết hàng</h5>
                                <p class="mb-0">Đang hiển thị các sản phẩm có số lượng tồn kho dưới 10 đơn vị</p>
                            </div>
                        </div>
                        <a href="@Url.Action("StockRefill", "Storage")" class="btn btn-sm btn-outline-secondary mt-2">
                            <i class="bi bi-x-circle me-1"></i> Xóa bộ lọc
                        </a>
                    </div>
                }

                <div class="d-flex justify-content-between align-items-center mt-3">
                    <div>
                        Hiển thị @Model.PageSize phiếu nhập kho
                    </div>
                    <nav>
                        <ul class="pagination">
                            <li class="page-item @(Model.Page == 1 ? "disabled" : "")">
                                <a class="page-link" href="@Url.Action("StockRefill", new { page = Model.Page - 1, pageSize = Model.PageSize, searchTerm = Model.SearchTerm, lowStockOnly = Model.LowStockOnly })">«</a>
                            </li>
                            @for (int i = 1; i <= Model.TotalPages; i++)
                            {
                                <li class="page-item @(i == Model.Page ? "active" : "")">
                                    <a class="page-link" href="@Url.Action("StockRefill", new { page = i, pageSize = Model.PageSize, searchTerm = Model.SearchTerm, lowStockOnly = Model.LowStockOnly })">@i</a>
                                </li>
                            }
                            <li class="page-item @(Model.Page == Model.TotalPages ? "disabled" : "")">
                                <a class="page-link" href="@Url.Action("StockRefill", new { page = Model.Page + 1, pageSize = Model.PageSize, searchTerm = Model.SearchTerm, lowStockOnly = Model.LowStockOnly })">»</a>
                            </li>
                        </ul>
                    </nav>
                </div>
            </div>
        </div>
    </div>
</div>

@section Scripts {
    <script>
        $(document).ready(function () {
            setTimeout(function () {
                $(".alert").alert('close');
            }, 5000);
        });
    </script>
}