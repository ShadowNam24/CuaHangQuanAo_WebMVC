@model CuaHangQuanAo.Models.RegisterViewModel
@{
    ViewData["Title"] = "Đăng ký";
    Layout = "_AuthenLayout";
}
<link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.css" rel="stylesheet">

<style>
    /* ===== Layout ===== */
    .auth-wrap {
        min-height: calc(100vh - 140px);
        display: flex;
        align-items: center;
        justify-content: center;
        padding: 2rem 1rem;
        background: linear-gradient(135deg,#f7f7f7 0%,#ffffff 40%,#f1f5f9 100%);
    }

    .auth-card {
        width: 100%;
        max-width: 1080px;
        border: 0;
        border-radius: 24px;
        overflow: hidden;
        box-shadow: 0 20px 60px rgba(0,0,0,.12);
    }

    .auth-left {
        background: url('/Images/demo/bg-fashion.jpg') center/cover no-repeat;
        position: relative;
        min-height: 640px;
    }

        .auth-left::after {
            content: "";
            position: absolute;
            inset: 0;
            background: linear-gradient(135deg,rgba(0,0,0,.55),rgba(0,0,0,.35));
        }

    .branding {
        position: absolute;
        z-index: 2;
        top: 24px;
        left: 24px;
        color: #fff;
        display: flex;
        align-items: center;
        gap: .5rem;
        letter-spacing: 2px;
    }

        .branding .dot {
            width: 10px;
            height: 10px;
            border-radius: 50%;
            background: #ffd166;
            display: inline-block;
        }

    .auth-caption {
        position: absolute;
        z-index: 2;
        left: 24px;
        right: 24px;
        bottom: 24px;
        color: #fff;
    }

        .auth-caption h3 {
            font-weight: 800;
            margin: 0 0 .25rem;
        }

    .auth-right {
        background: #fff;
        padding: 2rem 1.25rem;
    }

    {
        padding: 2.5rem 2rem 2rem;
    }

    }

    /* ===== Form styles ===== */
    h4.auth-title {
        font-weight: 800;
        letter-spacing: .5px;
        margin: 0 0 .25rem;
    }

    .auth-sub {
        color: #6b7280;
        margin-bottom: 1rem;
    }

    .section-title {
        font-weight: 700;
        margin: 1.25rem 0 .75rem;
    }

    .input-group-text {
        background: #fff;
        border-color: #e5e7eb;
    }

    .form-control {
        border-color: #e5e7eb;
    }

        .form-control:focus {
            box-shadow: 0 0 0 .25rem rgba(230,126,34,.15);
            border-color: #e67e22;
        }

    .rounded-12 {
        border-radius: 12px;
    }

    .btn-primary {
        background: #111827;
        border-color: #111827;
        border-radius: 12px;
        padding: .85rem 1rem;
        font-weight: 700;
        letter-spacing: .3px;
    }

        .btn-primary:hover {
            background: #e67e22;
            border-color: #e67e22;
        }

    .btn-outline {
        border: 1px solid #e5e7eb;
        background: #fff;
        color: #111827;
        border-radius: 12px;
        padding: .75rem 1rem;
        font-weight: 600;
    }

    .small-links a {
        color: #111827;
        text-decoration: none;
    }

        .small-links a:hover {
            text-decoration: underline;
        }

    .no-select {
        -webkit-user-select: none;
        -moz-user-select: none;
        -ms-user-select: none;
        user-select: none;
        -webkit-touch-callout: none;
        -webkit-tap-highlight-color: transparent;
    }
</style>

<div class="auth-wrap">
    <div class="card auth-card">
        <div class="row g-0">

            <!-- Left visual -->
            <div class="col-lg-5 position-relative auth-left">
                <div class="branding">
                    <span class="dot"></span>
                    <a asp-controller="Home" asp-action="Index" class="text-white text-decoration-none fw-bold">
                        ShopQuanAo
                    </a>
                </div>
                <div class="auth-caption">
                    <h3>Tạo tài khoản mới</h3>
                    <p>Đăng ký để nhận ưu đãi và theo dõi đơn hàng nhanh chóng.</p>
                </div>
            </div>

            <!-- Right form -->
            <div class="col-lg-7 auth-right">
                <h4 class="auth-title">Đăng ký</h4>
                <div class="auth-sub">Chỉ mất một phút để hoàn tất ✨</div>

                <form asp-action="Register" method="post" novalidate>
                    <div asp-validation-summary="ModelOnly" class="text-danger mb-2"></div>

                    <!-- Account Information -->
                    <div class="section-title">Thông tin tài khoản</div>
                    <div class="row">
                        <div class="col-md-6 mb-3">
                            <label asp-for="Username" class="form-label">Tên đăng nhập</label>
                            <div class="input-group rounded-12">
                                <span class="input-group-text"><i class="bi bi-person"></i></span>
                                <input asp-for="Username" class="form-control" placeholder="john_doe" />
                            </div>
                            <span asp-validation-for="Username" class="text-danger small"></span>
                        </div>

                        <div class="col-md-6 mb-3">
                            <label asp-for="Email" class="form-label">Email</label>
                            <div class="input-group rounded-12">
                                <span class="input-group-text"><i class="bi bi-envelope"></i></span>
                                <input asp-for="Email" class="form-control" placeholder="you@example.com" />
                            </div>
                            <span asp-validation-for="Email" class="text-danger small"></span>
                        </div>
                    </div>

                    <div class="row">
                        <div class="col-md-6 mb-3">
                            <label asp-for="Password" class="form-label">Mật khẩu</label>
                            <div class="input-group rounded-12">
                                <span class="input-group-text"><i class="bi bi-shield-lock"></i></span>
                                <input asp-for="Password" id="registerPassword" class="form-control no-select" type="password" placeholder="••••••••" />
                                <button type="button" class="btn btn-outline" id="toggleRegisterPassword" title="Hiện/ẩn mật khẩu">
                                    <i class="bi bi-eye" id="registerPasswordIcon"></i>
                                </button>
                            </div>
                            <span asp-validation-for="Password" class="text-danger small"></span>
                        </div>

                        <div class="col-md-6 mb-3">
                            <label asp-for="ConfirmPassword" class="form-label">Xác nhận mật khẩu</label>
                            <div class="input-group rounded-12">
                                <span class="input-group-text"><i class="bi bi-shield-check"></i></span>
                                <input asp-for="ConfirmPassword" id="registerConfirmPassword" class="form-control no-select" type="password" placeholder="••••••••" />
                                <button type="button" class="btn btn-outline" id="toggleRegisterConfirmPassword" title="Hiện/ẩn mật khẩu">
                                    <i class="bi bi-eye" id="registerConfirmPasswordIcon"></i>
                                </button>
                            </div>
                            <span asp-validation-for="ConfirmPassword" class="text-danger small"></span>
                        </div>
                    </div>

                    <hr class="my-3" />

                    <!-- Personal Information -->
                    <div class="section-title">Thông tin cá nhân</div>
                    <div class="row">
                        <div class="col-md-6 mb-3">
                            <label asp-for="FirstName" class="form-label">Họ</label>
                            <div class="input-group rounded-12">
                                <span class="input-group-text"><i class="bi bi-person-badge"></i></span>
                                <input asp-for="FirstName" class="form-control" />
                            </div>
                            <span asp-validation-for="FirstName" class="text-danger small"></span>
                        </div>

                        <div class="col-md-6 mb-3">
                            <label asp-for="LastName" class="form-label">Tên</label>
                            <div class="input-group rounded-12">
                                <span class="input-group-text"><i class="bi bi-person-badge-fill"></i></span>
                                <input asp-for="LastName" class="form-control" />
                            </div>
                            <span asp-validation-for="LastName" class="text-danger small"></span>
                        </div>
                    </div>

                    <div class="row">
                        <div class="col-md-6 mb-3">
                            <label asp-for="Phone" class="form-label">Số điện thoại</label>
                            <div class="input-group rounded-12">
                                <span class="input-group-text"><i class="bi bi-telephone"></i></span>
                                <input asp-for="Phone" class="form-control" />
                            </div>
                            <span asp-validation-for="Phone" class="text-danger small"></span>
                        </div>

                        <div class="col-md-6 mb-3">
                            <label asp-for="Address" class="form-label">Địa chỉ</label>
                            <div class="input-group rounded-12">
                                <span class="input-group-text"><i class="bi bi-geo-alt"></i></span>
                                <input asp-for="Address" class="form-control" />
                            </div>
                            <span asp-validation-for="Address" class="text-danger small"></span>
                        </div>
                    </div>

                    <div class="row">
                        <div class="col-md-6 mb-3">
                            <label asp-for="City" class="form-label">Thành phố</label>
                            <div class="input-group rounded-12">
                                <span class="input-group-text"><i class="bi bi-buildings"></i></span>
                                <input asp-for="City" class="form-control" />
                            </div>
                            <span asp-validation-for="City" class="text-danger small"></span>
                        </div>
                    </div>

                    <div class="d-grid mt-2">
                        <button type="submit" class="btn btn-primary" id="RegisterConfirm">
                            <i class="bi bi-person-plus me-1"></i> Đăng ký
                        </button>
                    </div>
                </form>

                <div class="text-center mt-3 small-links">
                    Đã có tài khoản? <a asp-action="Login">Đăng nhập ngay</a>
                </div>
            </div>
        </div>
    </div>
</div>

@section Scripts {
    @{
        await Html.RenderPartialAsync("_ValidationScriptsPartial");
    }
    <script>
        function bindToggle(btnId, inputId, iconId){
            const btn = document.getElementById(btnId);
            const input = document.getElementById(inputId);
            const icon = document.getElementById(iconId);
            btn?.addEventListener('click', ()=>{
                if(input.type === 'password'){
                    input.type = 'text';
                    icon.classList.replace('bi-eye','bi-eye-slash');
                }else{
                    input.type = 'password';
                    icon.classList.replace('bi-eye-slash','bi-eye');
                }
            });
        }
        bindToggle('toggleRegisterPassword','registerPassword','registerPasswordIcon');
        bindToggle('toggleRegisterConfirmPassword','registerConfirmPassword','registerConfirmPasswordIcon');
        class PasswordSecurity {
            constructor(selector) {
                this.inputs = document.querySelectorAll(selector);
                this.init();
            }

            init() {
                this.inputs.forEach(input => this.secureInput(input));
            }

            secureInput(input) {
                const blockedEvents = [
                    'paste', 'copy', 'cut', 'drag', 'drop',
                    'contextmenu', 'selectstart', 'dragstart'
                ];

                blockedEvents.forEach(event => {
                    input.addEventListener(event, this.preventAction.bind(this));
                });

                input.addEventListener('keydown', this.blockShortcuts.bind(this));

                // Apply CSS protection
                input.style.userSelect = 'none';
                input.style.webkitUserSelect = 'none';
                input.style.mozUserSelect = 'none';
                input.style.webkitTouchCallout = 'none';
                input.style.webkitTapHighlightColor = 'transparent';
            }

            preventAction(e) {
                e.preventDefault();
                e.stopImmediatePropagation();
                this.showSecurityWarning();
                return false;
            }

            blockShortcuts(e) {
                const blockedCombos = [
                    { ctrl: true, key: 'c' },
                    { ctrl: true, key: 'v' },
                    { ctrl: true, key: 'x' },
                    { ctrl: true, key: 'a' }
                ];

                const isBlocked = blockedCombos.some(combo =>
                    (combo.ctrl && (e.ctrlKey || e.metaKey)) &&
                    e.key.toLowerCase() === combo.key
                );

                if (isBlocked) {
                    e.preventDefault();
                    this.showSecurityWarning();
                }
            }

            showSecurityWarning() {
                const warning = document.createElement('div');
                warning.className = 'alert alert-warning alert-dismissible fade show position-fixed';
                warning.style.cssText = 'top: 20px; right: 20px; z-index: 9999; max-width: 300px;';
                warning.innerHTML = `
                    🔒 Copy/paste disabled for security reasons
                    <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
                `;
                document.body.appendChild(warning);

                setTimeout(() => {
                    if (warning.parentNode) {
                        warning.remove();
                    }
                }, 3000);
            }
        }

        function showWarning(message) {
            const warning = document.createElement('div');
            warning.className = 'alert alert-info alert-dismissible fade show position-fixed';
            warning.style.cssText = 'top: 20px; right: 20px; z-index: 9999; max-width: 300px;';
            warning.innerHTML = `
                ⚠️ ${message}
                <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
            `;
            document.body.appendChild(warning);

            setTimeout(() => {
                if (warning.parentNode) {
                    warning.remove();
                }
            }, 3000);
        }

        // Initialize all methods
        document.addEventListener('DOMContentLoaded', function() {
            // Apply Method 3 to specific inputs
            new PasswordSecurity('#registerPassword, #RegisterConfirm');
        });
    </script>
}
